<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitnessPro - Полная трансформация тела</title>
    <link rel="manifest" href="manifest.json">
    <style>
        :root {
            /* Современная темная палитра */
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-elevated: #2a2a2a;
            --bg-card: #1e1e1e;
            --bg-input: #2a2a2a;
            --bg-glass: rgba(30, 30, 30, 0.8);
            
            /* Текст с улучшенной контрастностью */
            --text-primary: #ffffff;
            --text-secondary: #a3a3a3;
            --text-muted: #737373;
            --text-accent: #f3f4f6;
            
            /* Яркие акценты */
            --accent-primary: #6366f1;
            --accent-secondary: #10b981;
            --accent-warning: #f59e0b;
            --accent-danger: #ef4444;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-blue: #3b82f6;
            
            /* Градиенты */
            --gradient-primary: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --gradient-secondary: linear-gradient(135deg, #10b981 0%, #059669 100%);
            --gradient-card: linear-gradient(145deg, #1e1e1e 0%, #2a2a2a 100%);
            --gradient-glass: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
            
            /* Тени */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.3);
            
            /* Пространство */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            
            /* Радиусы */
            --radius-sm: 6px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 50%;
            
            /* Анимации */
            --transition-fast: 0.15s ease;
            --transition-normal: 0.3s ease;
            --transition-slow: 0.5s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Inter', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* Стеклянный эффект */
        .glass {
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            background: var(--bg-glass);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Анимированный фон */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
            z-index: -1;
            animation: backgroundShift 20s ease-in-out infinite;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .container {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .header {
            padding: var(--space-xl) var(--space-lg);
            background: var(--gradient-primary);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-glass);
            backdrop-filter: blur(10px);
            z-index: 1;
        }

        .header > * {
            position: relative;
            z-index: 2;
        }

        .header h1 {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: var(--space-sm);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            letter-spacing: -0.5px;
        }

        .header p {
            font-weight: 500;
            opacity: 0.9;
            text-shadow: 0 1px 5px rgba(0, 0, 0, 0.3);
        }

        .main {
            flex: 1;
            padding: var(--space-lg) var(--space-md);
            padding-bottom: 100px;
        }

        .day-selector {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-xl);
        }

        .day-card {
            background: var(--gradient-card);
            border-radius: var(--radius-lg);
            padding: var(--space-md);
            text-align: center;
            cursor: pointer;
            transition: all var(--transition-normal);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .day-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-glass);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .day-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-md);
            border-color: var(--accent-primary);
        }

        .day-card:hover::before {
            opacity: 1;
        }

        .day-card.active {
            border-color: var(--accent-primary);
            background: var(--gradient-primary);
            box-shadow: var(--shadow-glow);
            transform: translateY(-2px);
        }

        .day-card.completed {
            background: var(--gradient-secondary);
            border-color: var(--accent-secondary);
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.3);
        }

        .day-card.rest {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 0 0 15px rgba(245, 158, 11, 0.2);
        }

        .day-number {
            font-size: 20px;
            font-weight: 800;
            margin-bottom: var(--space-xs);
            position: relative;
            z-index: 2;
        }

        .day-name {
            font-size: 11px;
            color: var(--text-secondary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            z-index: 2;
        }

        .day-card.active .day-name,
        .day-card.completed .day-name,
        .day-card.rest .day-name {
            color: rgba(255, 255, 255, 0.9);
        }

        .exercise-card {
            background: var(--gradient-card);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-lg);
            border-left: 4px solid var(--accent-primary);
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }

        .exercise-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-glass);
            opacity: 0;
            transition: all var(--transition-normal);
            pointer-events: none;
        }

        .exercise-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .exercise-card:hover::before {
            opacity: 1;
        }

        .exercise-gif {
            width: 100%;
            max-width: 200px;
            height: 150px;
            object-fit: cover;
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
            background: var(--gradient-card);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 12px;
            text-align: center;
            border: 2px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition-normal);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .exercise-gif::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-primary);
            opacity: 0;
            transition: all var(--transition-normal);
        }

        .exercise-gif:hover {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow-glow);
            transform: scale(1.02);
        }

        .exercise-gif:hover::before {
            opacity: 0.1;
        }

        .muscle-group {
            display: inline-block;
            background: var(--gradient-secondary);
            color: white;
            padding: 6px 12px;
            border-radius: var(--radius-full);
            font-size: 10px;
            font-weight: 700;
            margin-right: var(--space-sm);
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-fast);
        }

        .muscle-group:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .workout-duration {
            background: var(--gradient-card);
            padding: var(--space-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--space-xl);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-sm);
        }

        .duration-timer {
            font-size: 28px;
            font-weight: 800;
            color: var(--accent-primary);
            text-shadow: 0 2px 10px rgba(99, 102, 241, 0.3);
            margin-bottom: var(--space-xs);
        }

        .exercise-difficulty {
            display: flex;
            align-items: center;
            gap: 2px;
            margin-bottom: var(--space-sm);
        }

        .difficulty-star {
            color: var(--accent-warning);
            font-size: 14px;
            text-shadow: 0 1px 3px rgba(245, 158, 11, 0.3);
        }

        .exercise-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
        }

        .exercise-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }

        .exercise-name {
            font-size: 20px;
            font-weight: 700;
            color: var(--text-accent);
            line-height: 1.3;
        }

        .exercise-target {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: var(--space-sm);
        }

        .exercise-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .stat {
            text-align: center;
            background: rgba(255, 255, 255, 0.05);
            padding: var(--space-md);
            border-radius: var(--radius-md);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all var(--transition-normal);
        }

        .stat:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-1px);
        }

        .stat-value {
            font-size: 22px;
            font-weight: 800;
            color: var(--accent-primary);
            margin-bottom: var(--space-xs);
            text-shadow: 0 1px 5px rgba(99, 102, 241, 0.3);
        }

        .stat-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .exercise-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: var(--space-sm);
        }

        .btn {
            padding: var(--space-md) var(--space-lg);
            border: none;
            border-radius: var(--radius-md);
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all var(--transition-normal);
            text-align: center;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: all var(--transition-slow);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: var(--gradient-primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .btn-secondary {
            background: var(--gradient-card);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn-secondary:hover {
            background: var(--bg-elevated);
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: var(--space-md);
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: var(--space-sm);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 -4px 32px rgba(0, 0, 0, 0.3);
        }

        .nav-item {
            background: none;
            border: none;
            color: var(--text-muted);
            font-size: 11px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-sm);
            border-radius: var(--radius-md);
            transition: all var(--transition-normal);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--gradient-primary);
            opacity: 0;
            transition: all var(--transition-normal);
            border-radius: var(--radius-md);
        }

        .nav-item:hover {
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .nav-item:hover::before {
            opacity: 0.1;
        }

        .nav-item.active {
            color: var(--accent-primary);
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.2);
            transform: translateY(-1px);
        }

        .nav-item.active::before {
            opacity: 0.2;
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            transition: all var(--transition-normal);
            position: relative;
            z-index: 2;
        }

        .nav-item:hover .nav-icon {
            transform: scale(1.1);
        }

        .nav-item.active .nav-icon {
            transform: scale(1.05);
            filter: drop-shadow(0 2px 8px rgba(99, 102, 241, 0.4));
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: modalFadeIn var(--transition-normal) ease;
        }

        @keyframes modalFadeIn {
            from {
                opacity: 0;
                backdrop-filter: blur(0px);
            }
            to {
                opacity: 1;
                backdrop-filter: blur(10px);
            }
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            max-width: 90vw;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-lg);
            animation: modalSlideIn var(--transition-normal) ease;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(50px) scale(0.9);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-xl);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: var(--space-lg);
        }

        .modal-title {
            font-size: 24px;
            font-weight: 800;
            color: var(--text-accent);
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .close-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-full);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-normal);
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            transform: scale(1.1);
        }

        .timer-display {
            text-align: center;
            font-size: 36px;
            font-weight: 800;
            color: var(--accent-primary);
            margin: var(--space-xl) 0;
            text-shadow: 0 2px 10px rgba(99, 102, 241, 0.4);
            transition: all var(--transition-normal);
        }

        .timer-display.running {
            color: var(--accent-secondary);
            text-shadow: 0 2px 10px rgba(16, 185, 129, 0.4);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .hidden {
            display: none !important;
        }

        .rest-day {
            text-align: center;
            padding: var(--space-lg);
        }

        .rest-icon {
            font-size: 48px;
            margin-bottom: var(--space-md);
        }

        .rest-title {
            font-size: 24px;
            margin-bottom: var(--space-md);
        }

        .hidden {
            display: none !important;
        }

        .rest-day {
            text-align: center;
            padding: var(--space-xl);
            background: var(--gradient-card);
            border-radius: var(--radius-xl);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: var(--shadow-lg);
        }

        .rest-icon {
            font-size: 64px;
            margin-bottom: var(--space-lg);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .rest-title {
            font-size: 28px;
            font-weight: 800;
            margin-bottom: var(--space-lg);
            color: var(--text-accent);
        }

        .rest-description {
            color: var(--text-secondary);
            line-height: 1.6;
            font-size: 16px;
        }

        .workout-header {
            margin-bottom: var(--space-xl);
        }

        .exercise-gif:hover {
            background: var(--bg-primary);
            cursor: pointer;
            transform: scale(1.02);
            transition: all var(--transition-normal);
        }

        .difficulty-star.filled {
            color: var(--accent-warning);
        }

        .difficulty-star.empty {
            color: var(--text-muted);
        }

        /* Улучшенная адаптивность */
        @media (max-width: 480px) {
            .container {
                max-width: 100%;
            }
            
            .header {
                padding: var(--space-lg) var(--space-md);
            }
            
            .header h1 {
                font-size: 24px;
            }
            
            .main {
                padding: var(--space-md);
            }
            
            .day-selector {
                gap: 6px;
            }
            
            .day-card {
                padding: var(--space-sm);
            }
            
            .day-number {
                font-size: 16px;
            }
            
            .day-name {
                font-size: 10px;
            }
            
            .exercise-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: var(--space-sm);
            }
            
            .exercise-actions {
                grid-template-columns: 1fr;
                gap: var(--space-sm);
            }
            
            .exercise-gif {
                max-width: 150px;
                height: 120px;
            }
            
            .modal-content {
                padding: var(--space-lg);
                margin: var(--space-md);
            }
            
            .navigation {
                padding: var(--space-sm);
            }
            
            .nav-item {
                padding: var(--space-xs);
                font-size: 10px;
            }
            
            .nav-icon {
                width: 20px;
                height: 20px;
            }
        }

        /* Плавные переходы для всех интерактивных элементов */
        * {
            transition: opacity var(--transition-fast), transform var(--transition-fast);
        }

        /* Улучшенные скроллбары */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--gradient-primary);
            border-radius: var(--radius-sm);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-purple);
        }

        /* Анимации загрузки */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>💪 FitnessPro</h1>
            <p>Профессиональная трансформация тела</p>
            <p style="font-size: 12px; color: var(--text-secondary);">7-дневная программа • 2 часа в день • Все группы мышц</p>
        </header>

        <main class="main">
            <!-- Day Selector -->
            <div class="day-selector" id="daySelector">
                <!-- Generated by JS -->
            </div>

            <!-- Workout Content -->
            <div id="workoutContent">
                <!-- Generated by JS -->
            </div>
        </main>

        <!-- Navigation -->
        <nav class="navigation">
            <button class="nav-item active" onclick="showWorkout()">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2L2 7v10c0 5.55 3.84 10 9 10s9-4.45 9-10V7l-10-5z"/>
                </svg>
                Тренировка
            </button>
            <button class="nav-item" onclick="showStats()">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 3v18h18v-2H5V3H3zm14 12h2v4h-2v-4zm-4-4h2v8h-2v-8zm-4-4h2v12H9V7z"/>
                </svg>
                Статистика
            </button>
            <button class="nav-item" onclick="showNutrition()">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                Питание
            </button>
            <button class="nav-item" onclick="showSettings()">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"/>
                </svg>
                Настройки
            </button>
        </nav>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Заголовок</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalContent">
                <!-- Content will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <script>
        // === ГЛОБАЛЬНЫЕ ПЕРЕМЕННЫЕ ===
        let currentDay = 1;
        let currentExercise = 0;
        let timerInterval = null;
        let timerSeconds = 0;

        // Данные пользователя
        let userData = {
            completedDays: [],
            completedExercises: {},
            streak: 0,
            totalWorkouts: 0,
            // Новые данные для прогрессии
            exerciseProgress: {}, // {exerciseName: {date: {weight: X, reps: Y, sets: Z}}}
            personalRecords: {}, // {exerciseName: {maxWeight: X, maxReps: Y, maxVolume: Z}}
            bodyMeasurements: {}, // {date: {weight: X, muscle: Y, fat: Z}}
            workoutHistory: [], // [{date: Date, day: X, duration: Y, calories: Z}]
            goals: {
                targetWeight: null,
                targetBodyFat: null,
                weeklyWorkouts: 7,
                preferredIntensity: 'medium' // low, medium, high, extreme
            }
        };

        // Программы тренировок - Полная трансформация тела (2 часа каждая)
        const workoutPrograms = {
            1: {
                title: "ГРУДЬ + ТРИЦЕПС + ПЛЕЧИ",
                duration: "~120 минут",
                targetMuscles: ["Грудь", "Трицепс", "Передние дельты"],
                exercises: [
                    // РАЗМИНКА (10 мин)
                    { name: "Разминка суставов", category: "Разминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "warmup-joints.gif", muscles: ["Все тело"] },
                    { name: "Кардио разогрев", category: "Разминка", sets: 1, reps: "5 мин", rest: 60, difficulty: 1, gif: "cardio-warmup.gif", muscles: ["Сердце"] },
                    
                    // ГРУДЬ (45 мин)
                    { name: "Жим штанги лежа", category: "Грудь", sets: 4, reps: "8-12", rest: 180, difficulty: 4, gif: "bench-press.gif", muscles: ["Грудь", "Трицепс", "Плечи"] },
                    { name: "Жим гантелей под углом", category: "Грудь", sets: 4, reps: "10-12", rest: 150, difficulty: 3, gif: "incline-db-press.gif", muscles: ["Верх груди", "Плечи"] },
                    { name: "Отжимания на брусьях", category: "Грудь", sets: 3, reps: "8-15", rest: 120, difficulty: 4, gif: "dips.gif", muscles: ["Низ груди", "Трицепс"] },
                    { name: "Разводка гантелей", category: "Грудь", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "db-flyes.gif", muscles: ["Грудь"] },
                    { name: "Кроссовер на блоках", category: "Грудь", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "cable-crossover.gif", muscles: ["Грудь"] },
                    
                    // ТРИЦЕПС (35 мин)
                    { name: "Жим узким хватом", category: "Трицепс", sets: 4, reps: "8-12", rest: 150, difficulty: 4, gif: "close-grip-press.gif", muscles: ["Трицепс", "Грудь"] },
                    { name: "Французский жим", category: "Трицепс", sets: 4, reps: "10-12", rest: 120, difficulty: 3, gif: "skull-crushers.gif", muscles: ["Трицепс"] },
                    { name: "Разгибания на блоке", category: "Трицепс", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "tricep-pushdowns.gif", muscles: ["Трицепс"] },
                    { name: "Отжимания узким хватом", category: "Трицепс", sets: 3, reps: "до отказа", rest: 90, difficulty: 3, gif: "diamond-pushups.gif", muscles: ["Трицепс"] },
                    
                    // ПЛЕЧИ (25 мин)
                    { name: "Жим гантелей сидя", category: "Плечи", sets: 4, reps: "10-12", rest: 120, difficulty: 3, gif: "seated-db-press.gif", muscles: ["Плечи"] },
                    { name: "Махи в стороны", category: "Плечи", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "lateral-raises.gif", muscles: ["Средние дельты"] },
                    { name: "Махи в наклоне", category: "Плечи", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "rear-delt-flyes.gif", muscles: ["Задние дельты"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Растяжка верха тела", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "upper-stretch.gif", muscles: ["Все тело"] }
                ]
            },
            2: {
                title: "СПИНА + БИЦЕПС + ПРЕДПЛЕЧЬЯ",
                duration: "~120 минут", 
                targetMuscles: ["Спина", "Бицепс", "Предплечья"],
                exercises: [
                    // РАЗМИНКА (10 мин)
                    { name: "Разминка суставов", category: "Разминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "warmup-joints.gif", muscles: ["Все тело"] },
                    { name: "Кардио разогрев", category: "Разминка", sets: 1, reps: "5 мин", rest: 60, difficulty: 1, gif: "cardio-warmup.gif", muscles: ["Сердце"] },
                    
                    // СПИНА (50 мин)
                    { name: "Становая тяга", category: "Спина", sets: 4, reps: "6-8", rest: 240, difficulty: 5, gif: "deadlift.gif", muscles: ["Спина", "Ноги", "Трапеции"] },
                    { name: "Подтягивания", category: "Спина", sets: 4, reps: "6-12", rest: 180, difficulty: 4, gif: "pull-ups.gif", muscles: ["Широчайшие", "Бицепс"] },
                    { name: "Тяга штанги в наклоне", category: "Спина", sets: 4, reps: "8-12", rest: 150, difficulty: 4, gif: "barbell-rows.gif", muscles: ["Широчайшие", "Ромбовидные"] },
                    { name: "Тяга гантели одной рукой", category: "Спина", sets: 3, reps: "10-12", rest: 120, difficulty: 3, gif: "one-arm-row.gif", muscles: ["Широчайшие"] },
                    { name: "Тяга к поясу сидя", category: "Спина", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "seated-cable-row.gif", muscles: ["Широчайшие", "Ромбовидные"] },
                    { name: "Шраги с гантелями", category: "Спина", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "db-shrugs.gif", muscles: ["Трапеции"] },
                    
                    // БИЦЕПС (35 мин)
                    { name: "Подъемы штанги на бицепс", category: "Бицепс", sets: 4, reps: "8-12", rest: 120, difficulty: 3, gif: "barbell-curls.gif", muscles: ["Бицепс"] },
                    { name: "Молотковые подъемы", category: "Бицепс", sets: 4, reps: "10-12", rest: 120, difficulty: 3, gif: "hammer-curls.gif", muscles: ["Бицепс", "Предплечья"] },
                    { name: "Концентрированные подъемы", category: "Бицепс", sets: 3, reps: "10-12", rest: 90, difficulty: 2, gif: "concentration-curls.gif", muscles: ["Бицепс"] },
                    { name: "Подъемы на блоке", category: "Бицепс", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "cable-curls.gif", muscles: ["Бицепс"] },
                    
                    // ПРЕДПЛЕЧЬЯ (20 мин)
                    { name: "Подъемы на предплечья", category: "Предплечья", sets: 4, reps: "15-20", rest: 60, difficulty: 2, gif: "wrist-curls.gif", muscles: ["Предплечья"] },
                    { name: "Обратные подъемы", category: "Предплечья", sets: 3, reps: "15-20", rest: 60, difficulty: 2, gif: "reverse-curls.gif", muscles: ["Предплечья"] },
                    { name: "Удержание грифа", category: "Предплечья", sets: 3, reps: "30-60 сек", rest: 90, difficulty: 3, gif: "farmers-walk.gif", muscles: ["Хват"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Растяжка спины и рук", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "back-stretch.gif", muscles: ["Все тело"] }
                ]
            },
            3: {
                title: "НОГИ + ЯГОДИЦЫ + ИКРЫ",
                duration: "~120 минут",
                targetMuscles: ["Квадрицепс", "Бицепс бедра", "Ягодицы", "Икры"],
                exercises: [
                    // РАЗМИНКА (10 мин)
                    { name: "Разминка суставов", category: "Разминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "warmup-joints.gif", muscles: ["Все тело"] },
                    { name: "Легкое кардио", category: "Разминка", sets: 1, reps: "5 мин", rest: 60, difficulty: 1, gif: "light-cardio.gif", muscles: ["Ноги"] },
                    
                    // КВАДРИЦЕПС + ЯГОДИЦЫ (60 мин)
                    { name: "Приседания со штангой", category: "Ноги", sets: 5, reps: "6-10", rest: 240, difficulty: 5, gif: "barbell-squats.gif", muscles: ["Квадрицепс", "Ягодицы"] },
                    { name: "Жим ногами", category: "Ноги", sets: 4, reps: "12-15", rest: 180, difficulty: 3, gif: "leg-press.gif", muscles: ["Квадрицепс", "Ягодицы"] },
                    { name: "Выпады с гантелями", category: "Ноги", sets: 4, reps: "10-12", rest: 150, difficulty: 4, gif: "db-lunges.gif", muscles: ["Квадрицепс", "Ягодицы"] },
                    { name: "Болгарские приседания", category: "Ноги", sets: 3, reps: "12-15", rest: 120, difficulty: 3, gif: "bulgarian-squats.gif", muscles: ["Квадрицепс", "Ягодицы"] },
                    { name: "Разгибания ног", category: "Ноги", sets: 3, reps: "12-15", rest: 90, difficulty: 2, gif: "leg-extensions.gif", muscles: ["Квадрицепс"] },
                    
                    // БИЦЕПС БЕДРА (25 мин)
                    { name: "Румынская тяга", category: "Ноги", sets: 4, reps: "10-12", rest: 150, difficulty: 4, gif: "romanian-deadlift.gif", muscles: ["Бицепс бедра", "Ягодицы"] },
                    { name: "Сгибания ног лежа", category: "Ноги", sets: 4, reps: "12-15", rest: 120, difficulty: 2, gif: "leg-curls.gif", muscles: ["Бицепс бедра"] },
                    { name: "Гиперэкстензия", category: "Ноги", sets: 3, reps: "15-20", rest: 90, difficulty: 2, gif: "hyperextensions.gif", muscles: ["Бицепс бедра", "Ягодицы"] },
                    
                    // ИКРЫ (20 мин)
                    { name: "Подъемы на носки стоя", category: "Икры", sets: 5, reps: "15-20", rest: 90, difficulty: 2, gif: "calf-raises.gif", muscles: ["Икры"] },
                    { name: "Подъемы сидя", category: "Икры", sets: 4, reps: "15-20", rest: 60, difficulty: 2, gif: "seated-calf-raises.gif", muscles: ["Камбаловидные"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Растяжка ног", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "leg-stretch.gif", muscles: ["Все тело"] }
                ]
            },
            4: { 
                title: "АКТИВНОЕ ВОССТАНОВЛЕНИЕ", 
                isRest: false,
                duration: "~60 минут",
                targetMuscles: ["Кардио", "Гибкость", "Мобильность"],
                exercises: [
                    { name: "Легкое кардио", category: "Кардио", sets: 1, reps: "20 мин", rest: 0, difficulty: 1, gif: "light-cardio.gif", muscles: ["Сердце"] },
                    { name: "Йога/Растяжка", category: "Гибкость", sets: 1, reps: "30 мин", rest: 0, difficulty: 1, gif: "yoga-flow.gif", muscles: ["Все тело"] },
                    { name: "Дыхательные упражнения", category: "Восстановление", sets: 1, reps: "10 мин", rest: 0, difficulty: 1, gif: "breathing.gif", muscles: ["Диафрагма"] }
                ]
            },
            5: {
                title: "ФУНКЦИОНАЛЬНАЯ СИЛА",
                duration: "~120 минут",
                targetMuscles: ["Кор", "Стабилизаторы", "Взрывная сила"],
                exercises: [
                    // РАЗМИНКА (10 мин)
                    { name: "Динамическая разминка", category: "Разминка", sets: 1, reps: "10 мин", rest: 0, difficulty: 2, gif: "dynamic-warmup.gif", muscles: ["Все тело"] },
                    
                    // ФУНКЦИОНАЛЬНЫЕ ДВИЖЕНИЯ (70 мин)
                    { name: "Берпи", category: "Функциональные", sets: 5, reps: "10-15", rest: 120, difficulty: 4, gif: "burpees.gif", muscles: ["Все тело"] },
                    { name: "Толчки гири", category: "Функциональные", sets: 4, reps: "8-12", rest: 150, difficulty: 4, gif: "kettlebell-swings.gif", muscles: ["Задняя цепь"] },
                    { name: "Тяга троса к лицу", category: "Функциональные", sets: 4, reps: "12-15", rest: 90, difficulty: 2, gif: "face-pulls.gif", muscles: ["Задние дельты"] },
                    { name: "Планка", category: "Кор", sets: 4, reps: "60-90 сек", rest: 90, difficulty: 3, gif: "plank.gif", muscles: ["Кор"] },
                    { name: "Подъемы ног в висе", category: "Кор", sets: 4, reps: "10-15", rest: 120, difficulty: 4, gif: "hanging-leg-raises.gif", muscles: ["Пресс"] },
                    { name: "Русские скручивания", category: "Кор", sets: 3, reps: "20-30", rest: 60, difficulty: 2, gif: "russian-twists.gif", muscles: ["Косые"] },
                    { name: "Горные альпинисты", category: "Кор", sets: 3, reps: "30-45 сек", rest: 60, difficulty: 3, gif: "mountain-climbers.gif", muscles: ["Кор", "Кардио"] },
                    { name: "Медвежья походка", category: "Функциональные", sets: 3, reps: "30-45 сек", rest: 90, difficulty: 3, gif: "bear-crawl.gif", muscles: ["Все тело"] },
                    
                    // ВЗРЫВНАЯ СИЛА (35 мин)
                    { name: "Прыжки на тумбу", category: "Плиометрика", sets: 4, reps: "8-12", rest: 120, difficulty: 3, gif: "box-jumps.gif", muscles: ["Ноги", "Взрывная сила"] },
                    { name: "Взрывные отжимания", category: "Плиометрика", sets: 3, reps: "5-10", rest: 120, difficulty: 4, gif: "explosive-pushups.gif", muscles: ["Грудь", "Взрывная сила"] },
                    { name: "Броски медбола", category: "Плиометрика", sets: 3, reps: "10-15", rest: 90, difficulty: 3, gif: "medicine-ball-throws.gif", muscles: ["Кор", "Взрывная сила"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Восстановительная растяжка", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "recovery-stretch.gif", muscles: ["Все тело"] }
                ]
            },
            6: {
                title: "ВЕРХ ТЕЛА + КАРДИО",
                duration: "~120 минут",
                targetMuscles: ["Грудь", "Спина", "Плечи", "Руки", "Кардио"],
                exercises: [
                    // РАЗМИНКА (10 мин)
                    { name: "Кардио разминка", category: "Разминка", sets: 1, reps: "10 мин", rest: 0, difficulty: 2, gif: "cardio-warmup.gif", muscles: ["Сердце"] },
                    
                    // ИНТЕРВАЛЬНАЯ ТРЕНИРОВКА (50 мин)
                    { name: "Суперсет: Жим + Тяга", category: "Суперсет", sets: 4, reps: "10-12", rest: 90, difficulty: 4, gif: "bench-row-superset.gif", muscles: ["Грудь", "Спина"] },
                    { name: "Суперсет: Жим + Подтягивания", category: "Суперсет", sets: 4, reps: "8-12", rest: 120, difficulty: 4, gif: "press-pullup-superset.gif", muscles: ["Плечи", "Спина"] },
                    { name: "Суперсет: Бицепс + Трицепс", category: "Суперсет", sets: 4, reps: "10-15", rest: 90, difficulty: 3, gif: "bicep-tricep-superset.gif", muscles: ["Руки"] },
                    { name: "Круговая тренировка", category: "Круговая", sets: 3, reps: "45 сек работа", rest: 15, difficulty: 4, gif: "upper-circuit.gif", muscles: ["Верх тела"] },
                    
                    // КАРДИО ФИНИШ (55 мин)
                    { name: "HIIT интервалы", category: "Кардио", sets: 8, reps: "30 сек макс", rest: 90, difficulty: 5, gif: "hiit-intervals.gif", muscles: ["Кардио"] },
                    { name: "Средней интенсивности", category: "Кардио", sets: 1, reps: "20 мин", rest: 0, difficulty: 3, gif: "moderate-cardio.gif", muscles: ["Кардио"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Растяжка и релакс", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "cool-down.gif", muscles: ["Все тело"] }
                ]
            },
            7: {
                title: "ПОЛНАЯ ТРАНСФОРМАЦИЯ",
                duration: "~120 минут",
                targetMuscles: ["Все группы мышц", "Выносливость", "Сила"],
                exercises: [
                    // РАЗМИНКА (15 мин)
                    { name: "Полная мобилизация", category: "Разминка", sets: 1, reps: "15 мин", rest: 0, difficulty: 2, gif: "full-mobility.gif", muscles: ["Все тело"] },
                    
                    // СИЛОВОЙ БЛОК (60 мин)
                    { name: "Комплекс: Приседания + Жим + Тяга", category: "Комплекс", sets: 5, reps: "5-8", rest: 180, difficulty: 5, gif: "squat-press-row.gif", muscles: ["Все тело"] },
                    { name: "Становая + Подтягивания + Отжимания", category: "Комплекс", sets: 4, reps: "6-10", rest: 150, difficulty: 5, gif: "deadlift-pullup-pushup.gif", muscles: ["Все тело"] },
                    { name: "Выпады + Жим + Махи", category: "Комплекс", sets: 4, reps: "8-12", rest: 120, difficulty: 4, gif: "lunge-press-raise.gif", muscles: ["Все тело"] },
                    
                    // МЕТАБОЛИЧЕСКИЙ ФИНИШ (40 мин)
                    { name: "Табата протокол", category: "Интенсивное", sets: 8, reps: "20 сек макс", rest: 10, difficulty: 5, gif: "tabata-protocol.gif", muscles: ["Все тело"] },
                    { name: "Комплекс на выносливость", category: "Выносливость", sets: 3, reps: "10 мин", rest: 120, difficulty: 4, gif: "endurance-complex.gif", muscles: ["Все тело"] },
                    
                    // ЗАМИНКА (5 мин)
                    { name: "Глубокая растяжка", category: "Заминка", sets: 1, reps: "5 мин", rest: 0, difficulty: 1, gif: "deep-stretch.gif", muscles: ["Все тело"] }
                ]
            }
        };

        // === ОСНОВНЫЕ ФУНКЦИИ ===

        // Инициализация приложения
        function initApp() {
            loadUserData();
            generateDaySelector();
            selectDay(currentDay);
            updateNavigation('workout');
        }

        // Генерация селектора дней
        function generateDaySelector() {
            const selector = document.getElementById('daySelector');
            const dayNames = ['ПН', 'ВТ', 'СР', 'ЧТ', 'ПТ', 'СБ', 'ВС'];
            
            selector.innerHTML = '';
            
            for (let i = 1; i <= 7; i++) {
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                dayCard.onclick = () => selectDay(i);
                
                if (i === 4) dayCard.classList.add('rest');
                if (userData.completedDays.includes(i)) dayCard.classList.add('completed');
                if (i === currentDay) dayCard.classList.add('active');
                
                dayCard.innerHTML = `
                    <div class="day-number">${i}</div>
                    <div class="day-name">${dayNames[i-1]}</div>
                `;
                
                selector.appendChild(dayCard);
            }
        }

        // Выбор дня
        window.selectDay = function(day) {
            currentDay = day;
            
            // Обновить визуальное состояние
            document.querySelectorAll('.day-card').forEach((card, index) => {
                card.classList.toggle('active', index + 1 === day);
            });
            
            // Загрузить тренировку
            loadWorkout(day);
        }

        // Форматирование времени
        function formatTime(minutes) {
            if (minutes < 60) {
                return `${minutes} минут`;
            } else {
                const hours = Math.floor(minutes / 60);
                const remainingMinutes = minutes % 60;
                if (remainingMinutes === 0) {
                    return `${hours} час${hours > 1 ? 'а' : ''}`;
                }
                return `${hours} час ${remainingMinutes} минут`;
            }
        }

        // Расчет продолжительности тренировки
        function calculateDayDuration(exercises) {
            if (!exercises || exercises.length === 0) return 0;
            return exercises.reduce((total, exercise) => {
                const sets = exercise.sets || 3;
                const duration = exercise.duration || 1;
                const rest = exercise.rest || 30;
                return total + (sets * duration) + ((sets - 1) * rest / 60);
            }, 0);
        }

        // Загрузка тренировки
        function loadWorkout(day) {
            const content = document.getElementById('workoutContent');
            const program = workoutPrograms[day];
            
            if (program.isRest) {
                content.innerHTML = `
                    <div class="rest-day fade-in">
                        <div class="rest-icon">🧘‍♀️</div>
                        <h2 class="rest-title">${program.title}</h2>
                        <div class="workout-duration">
                            <div class="duration-timer">${program.duration}</div>
                            <p style="font-size: 14px; color: var(--text-secondary); margin-top: 8px; line-height: 1.5;">
                                Активное восстановление для лучших результатов:<br>
                                • Легкая прогулка или йога<br>
                                • Полноценный сон (8+ часов)<br>
                                • Правильное питание и гидратация
                            </p>
                        </div>
                        <div class="exercises">
                            ${program.exercises.map((exercise, index) => `
                                <div class="exercise-card fade-in" style="border-left: 4px solid var(--accent-secondary); animation-delay: ${index * 0.1}s;">
                                    <div class="exercise-header">
                                        <h3 class="exercise-name">${exercise.name}</h3>
                                        <div class="exercise-difficulty">
                                            ${'★'.repeat(exercise.difficulty)}${'☆'.repeat(5 - exercise.difficulty)}
                                        </div>
                                    </div>
                                    
                                    <div class="exercise-gif" onclick="showExerciseGif('${exercise.gif}', '${exercise.name}')">
                                        📺 Демонстрация техники
                                        <br><small>Нажмите для просмотра</small>
                                    </div>
                                    
                                    <div style="margin-bottom: var(--space-md);">
                                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Группы мышц:</div>
                                        ${exercise.muscles.map(muscle => `<span class="muscle-group">${muscle}</span>`).join('')}
                                    </div>
                                    
                                    <div class="exercise-stats">
                                        <div class="stat">
                                            <div class="stat-value">${exercise.sets}</div>
                                            <div class="stat-label">Подходы</div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-value">${exercise.reps}</div>
                                            <div class="stat-label">Продолжительность</div>
                                        </div>
                                        <div class="stat">
                                            <div class="stat-value">${exercise.rest > 0 ? exercise.rest + 'с' : '—'}</div>
                                            <div class="stat-label">Отдых</div>
                                        </div>
                                    </div>
                                    
                                    <div class="exercise-actions">
                                        ${exercise.rest > 0 ? `
                                            <button class="btn btn-primary" onclick="startTimer(${index}, ${exercise.rest})">
                                                Таймер отдыха
                                            </button>
                                        ` : ''}
                                        <button class="btn btn-secondary" onclick="completeExercise(${day}, ${index})">
                                            Выполнено
                                        </button>
                                    </div>
                                    
                                    <div class="timer-display hidden" id="timer-${index}">
                                        ${exercise.rest}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                return;
            }
            
            // Обычная тренировка
            const totalDuration = Math.round(calculateDayDuration(program.exercises));
            const exerciseCount = program.exercises.length;
            
            content.innerHTML = `
                <div class="workout-header fade-in">
                    <h2 style="color: var(--text-accent); font-size: 28px; font-weight: 800; margin-bottom: var(--space-md);">
                        ${program.title}
                    </h2>
                    <div style="display: flex; gap: var(--space-lg); margin-bottom: var(--space-lg); flex-wrap: wrap;">
                        <div style="padding: var(--space-sm) var(--space-md); background: var(--gradient-accent); border-radius: var(--radius-lg); color: white; font-weight: 600; font-size: 14px;">
                            ⏱️ ${formatTime(totalDuration)}
                        </div>
                        <div style="padding: var(--space-sm) var(--space-md); background: var(--gradient-secondary); border-radius: var(--radius-lg); color: white; font-weight: 600; font-size: 14px;">
                            💪 ${exerciseCount} упражнений
                        </div>
                        <div style="padding: var(--space-sm) var(--space-md); background: var(--gradient-warning); border-radius: var(--radius-lg); color: white; font-weight: 600; font-size: 14px;">
                            🎯 ${program.targetMuscles.join(' • ')}
                        </div>
                    </div>
                </div>
                
                <div class="exercises">
                    ${program.exercises.map((exercise, index) => {
                        const categoryColors = {
                            'Разминка': 'var(--accent-secondary)',
                            'Грудь': '#E53E3E',
                            'Спина': '#3182CE',
                            'Ноги': '#38A169',
                            'Плечи': '#D69E2E',
                            'Трицепс': '#805AD5',
                            'Бицепс': '#DD6B20',
                            'Предплечья': '#718096',
                            'Икры': '#2D3748',
                            'Кор': '#C53030',
                            'Функциональные': '#319795',
                            'Плиометрика': '#B83280',
                            'Суперсет': '#E53E3E',
                            'Круговая': '#38A169',
                            'Кардио': '#3182CE',
                            'Комплекс': '#805AD5',
                            'Интенсивное': '#C53030',
                            'Выносливость': '#D69E2E',
                            'Заминка': '#4A5568'
                        };
                        
                        return `
                            <div class="exercise-card" style="border-left: 4px solid ${categoryColors[exercise.category] || 'var(--accent-primary)'};">
                                <div class="exercise-header">
                                    <div>
                                        <h3 class="exercise-name">${exercise.name}</h3>
                                        <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">
                                            ${exercise.category}
                                        </div>
                                    </div>
                                    <div class="exercise-difficulty">
                                        ${'★'.repeat(exercise.difficulty)}${'☆'.repeat(5 - exercise.difficulty)}
                                    </div>
                                </div>
                                
                                <div class="exercise-gif" onclick="showExerciseGif('${exercise.gif}', '${exercise.name}')">
                                    📺 Техника выполнения
                                    <br><small>Нажмите для просмотра GIF</small>
                                </div>
                                
                                <div style="margin-bottom: var(--space-md);">
                                    <div style="font-size: 12px; color: var(--text-secondary); margin-bottom: 4px;">Работающие мышцы:</div>
                                    ${exercise.muscles.map(muscle => `<span class="muscle-group">${muscle}</span>`).join('')}
                                </div>
                                
                                <div class="exercise-stats">
                                    <div class="stat">
                                        <div class="stat-value">${exercise.sets}</div>
                                        <div class="stat-label">Подходы</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-value">${exercise.reps}</div>
                                        <div class="stat-label">Повторения</div>
                                    </div>
                                    <div class="stat">
                                        <div class="stat-value">${exercise.rest > 0 ? formatRestTime(exercise.rest) : '—'}</div>
                                        <div class="stat-label">Отдых</div>
                                    </div>
                                </div>
                                
                                <div class="exercise-actions">
                                    ${exercise.rest > 0 ? `
                                        <button class="btn btn-primary" onclick="startTimer(${index}, ${exercise.rest})">
                                            Таймер (${formatRestTime(exercise.rest)})
                                        </button>
                                    ` : ''}
                                    <button class="btn btn-secondary" onclick="showProgressForm(${index})">
                                        📊 Прогресс
                                    </button>
                                    <button class="btn btn-secondary" onclick="completeExercise(${day}, ${index})">
                                        ✓ Выполнено
                                    </button>
                                    <button class="btn btn-secondary" onclick="showExerciseDetails(${index})">
                                        📋 Детали
                                    </button>
                                </div>
                                
                                <div class="timer-display hidden" id="timer-${index}">
                                    ${exercise.rest}
                                </div>
                            </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        // Запуск таймера
        window.startTimer = function(exerciseIndex, duration) {
            if (timerInterval) clearInterval(timerInterval);
            
            const timerDisplay = document.getElementById(`timer-${exerciseIndex}`);
            timerDisplay.classList.remove('hidden');
            timerDisplay.classList.add('running');
            
            timerSeconds = duration;
            
            timerInterval = setInterval(() => {
                timerSeconds--;
                timerDisplay.textContent = formatTime(timerSeconds);
                
                if (timerSeconds <= 0) {
                    clearInterval(timerInterval);
                    timerDisplay.classList.remove('running');
                    timerDisplay.textContent = "Время вышло!";
                    
                    // Уведомление
                    if (Notification.permission === 'granted') {
                        new Notification('Отдых закончен!', {
                            body: 'Время для следующего подхода',
                            icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%233B82F6"/><text x="50" y="65" font-size="40" text-anchor="middle" fill="white">💪</text></svg>'
                        });
                    }
                }
            }, 1000);
        }

        // Форматирование времени отдыха
        function formatRestTime(seconds) {
            if (seconds >= 60) {
                const minutes = Math.floor(seconds / 60);
                const secs = seconds % 60;
                return secs > 0 ? `${minutes}м ${secs}с` : `${minutes}м`;
            }
            return `${seconds}с`;
        }

        // Показать GIF упражнения
        window.showExerciseGif = function(gifUrl, exerciseName) {
            const modalContent = `
                <div style="text-align: center;">
                    <h3 style="margin-bottom: 16px;">${exerciseName}</h3>
                    <div style="background: var(--bg-card); padding: 20px; border-radius: 12px; margin-bottom: 16px;">
                        <div style="
                            background: linear-gradient(45deg, #3B82F6, #10B981);
                            color: white;
                            padding: 40px;
                            border-radius: 12px;
                            font-size: 16px;
                        ">
                            🎬 GIF: ${gifUrl}
                            <br><br>
                            <small>В полной версии здесь будет анимация с техникой выполнения упражнения</small>
                        </div>
                    </div>
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px; text-align: left;">
                        <h4 style="margin-bottom: 8px;">Техника выполнения:</h4>
                        <ul style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            <li>Займите правильное исходное положение</li>
                            <li>Контролируйте движение на всей амплитуде</li>
                            <li>Дышите правильно: выдох на усилии</li>
                            <li>Держите мышцы кора в напряжении</li>
                            <li>Не торопитесь, качество важнее скорости</li>
                        </ul>
                    </div>
                </div>
            `;
            openModal(`Техника: ${exerciseName}`, modalContent);
        }

        // Показать детали упражнения
        window.showExerciseDetails = function(exerciseIndex) {
            const exercise = workoutPrograms[currentDay].exercises[exerciseIndex];
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 8px;">Основная информация</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; font-size: 14px;">
                            <div><strong>Категория:</strong> ${exercise.category}</div>
                            <div><strong>Сложность:</strong> ${'★'.repeat(exercise.difficulty)}${'☆'.repeat(5 - exercise.difficulty)}</div>
                            <div><strong>Подходы:</strong> ${exercise.sets}</div>
                            <div><strong>Повторения:</strong> ${exercise.reps}</div>
                            <div><strong>Отдых:</strong> ${exercise.rest > 0 ? formatRestTime(exercise.rest) : 'Без отдыха'}</div>
                            <div><strong>GIF файл:</strong> ${exercise.gif}</div>
                        </div>
                    </div>
                    
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 8px;">Работающие мышцы</h4>
                        <div style="display: flex; flex-wrap: wrap; gap: 4px;">
                            ${exercise.muscles.map(muscle => `<span class="muscle-group">${muscle}</span>`).join('')}
                        </div>
                    </div>
                    
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 8px;">Советы по выполнению</h4>
                        <ul style="color: var(--text-secondary); font-size: 14px; line-height: 1.6; margin: 0; padding-left: 20px;">
                            ${getExerciseTips(exercise.name).map(tip => `<li>${tip}</li>`).join('')}
                        </ul>
                    </div>
                    
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary" onclick="closeModal(); startTimer(${exerciseIndex}, ${exercise.rest})">
                            Начать упражнение
                        </button>
                        <button class="btn btn-secondary" onclick="showExerciseGif('${exercise.gif}', '${exercise.name}')">
                            Показать технику
                        </button>
                    </div>
                </div>
            `;
            openModal(exercise.name, modalContent);
        }

        // Получить советы для упражнения
        function getExerciseTips(exerciseName) {
            const tips = {
                'Жим штанги лежа': [
                    'Держите лопатки сведенными',
                    'Ноги плотно стоят на полу',
                    'Опускайте штангу до касания груди',
                    'Выжимайте мощно, но контролируемо'
                ],
                'Становая тяга': [
                    'Держите спину прямой на протяжении всего движения',
                    'Штанга должна скользить близко к телу',
                    'Начинайте движение с ног, затем выпрямляйте спину',
                    'В верхней точке полностью выпрямитесь'
                ],
                'Приседания со штангой': [
                    'Колени идут в одном направлении с носками',
                    'Опускайтесь до параллели бедер с полом',
                    'Держите грудь приподнятой',
                    'Выходите из приседа пятками'
                ],
                'default': [
                    'Контролируйте технику выполнения',
                    'Дышите правильно',
                    'Не торопитесь с увеличением веса',
                    'Чувствуйте работу целевых мышц'
                ]
            };
            
            return tips[exerciseName] || tips['default'];
        }

        // === СИСТЕМА ПРОГРЕССИИ ===

        // Записать результаты упражнения
        window.logExerciseProgress = function(exerciseName, weight, reps, sets) {
            const today = new Date().toISOString().split('T')[0];
            
            if (!userData.exerciseProgress[exerciseName]) {
                userData.exerciseProgress[exerciseName] = {};
            }
            
            userData.exerciseProgress[exerciseName][today] = {
                weight: parseFloat(weight) || 0,
                reps: parseInt(reps) || 0,
                sets: parseInt(sets) || 0,
                timestamp: new Date().toISOString()
            };
            
            updatePersonalRecords(exerciseName, weight, reps, sets);
            saveUserData();
        }

        // Обновить личные рекорды
        function updatePersonalRecords(exerciseName, weight, reps, sets) {
            if (!userData.personalRecords[exerciseName]) {
                userData.personalRecords[exerciseName] = {
                    maxWeight: 0,
                    maxReps: 0,
                    maxVolume: 0,
                    achievements: []
                };
            }
            
            const record = userData.personalRecords[exerciseName];
            const volume = (parseFloat(weight) || 0) * (parseInt(reps) || 0) * (parseInt(sets) || 0);
            
            // Проверяем новые рекорды
            let newAchievements = [];
            
            if (parseFloat(weight) > record.maxWeight) {
                record.maxWeight = parseFloat(weight);
                newAchievements.push(`Новый рекорд веса: ${weight} кг!`);
            }
            
            if (parseInt(reps) > record.maxReps) {
                record.maxReps = parseInt(reps);
                newAchievements.push(`Новый рекорд повторений: ${reps}!`);
            }
            
            if (volume > record.maxVolume) {
                record.maxVolume = volume;
                newAchievements.push(`Новый рекорд объема: ${volume.toFixed(1)} кг×повт!`);
            }
            
            // Добавляем достижения
            if (newAchievements.length > 0) {
                record.achievements.push({
                    date: new Date().toISOString(),
                    achievements: newAchievements
                });
                
                showNotification('🏆 Новый рекорд!', newAchievements.join(' '));
            }
        }

        // Получить последний результат упражнения
        function getLastExerciseResult(exerciseName) {
            const progress = userData.exerciseProgress[exerciseName];
            if (!progress) return null;
            
            const dates = Object.keys(progress).sort().reverse();
            return dates.length > 0 ? progress[dates[0]] : null;
        }

        // Показать форму логирования упражнения
        window.showProgressForm = function(exerciseIndex) {
            const exercise = workoutPrograms[currentDay].exercises[exerciseIndex];
            const lastResult = getLastExerciseResult(exercise.name);
            const record = userData.personalRecords[exercise.name];
            
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 12px;">Запишите результат</h4>
                        <form onsubmit="submitProgress(event, '${exercise.name}', ${exerciseIndex})" style="display: grid; gap: 12px;">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Вес (кг)</label>
                                    <input type="number" id="weight-input" step="0.5" min="0" 
                                           value="${lastResult?.weight || ''}" 
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Повторения</label>
                                    <input type="number" id="reps-input" min="1" 
                                           value="${lastResult?.reps || exercise.reps.split('-')[0] || ''}" 
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Подходы</label>
                                    <input type="number" id="sets-input" min="1" 
                                           value="${exercise.sets}" 
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Сохранить результат</button>
                        </form>
                    </div>
                    
                    ${lastResult ? `
                        <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                            <h4 style="margin-bottom: 8px;">Последний результат</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 14px;">
                                <div><strong>Вес:</strong> ${lastResult.weight} кг</div>
                                <div><strong>Повторения:</strong> ${lastResult.reps}</div>
                                <div><strong>Подходы:</strong> ${lastResult.sets}</div>
                            </div>
                        </div>
                    ` : ''}
                    
                    ${record ? `
                        <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                            <h4 style="margin-bottom: 8px;">🏆 Личные рекорды</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; font-size: 14px;">
                                <div><strong>Макс. вес:</strong> ${record.maxWeight} кг</div>
                                <div><strong>Макс. повторения:</strong> ${record.maxReps}</div>
                                <div><strong>Макс. объем:</strong> ${record.maxVolume.toFixed(1)}</div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            openModal(`Прогресс: ${exercise.name}`, modalContent);
        }

        // Отправить данные прогресса
        window.submitProgress = function(event, exerciseName, exerciseIndex) {
            event.preventDefault();
            
            const weight = document.getElementById('weight-input').value;
            const reps = document.getElementById('reps-input').value;
            const sets = document.getElementById('sets-input').value;
            
            if (!reps || !sets) {
                alert('Пожалуйста, заполните все обязательные поля');
                return;
            }
            
            logExerciseProgress(exerciseName, weight, reps, sets);
            completeExercise(currentDay, exerciseIndex);
            closeModal();
            
            showNotification('✅ Результат сохранен', `${exerciseName}: ${weight}кг × ${reps} × ${sets}`);
        }

        // Рассчитать калории для тренировки
        function calculateCalories(day) {
            const program = workoutPrograms[day];
            if (!program || program.isRest) return 0;
            
            // Примерный расчет калорий на основе типа упражнений и времени
            const baseCaloriesPerMinute = {
                'Разминка': 3,
                'Грудь': 8,
                'Спина': 9,
                'Ноги': 12,
                'Плечи': 6,
                'Трицепс': 5,
                'Бицепс': 5,
                'Предплечья': 3,
                'Икры': 4,
                'Кор': 6,
                'Функциональные': 10,
                'Плиометрика': 15,
                'Суперсет': 12,
                'Круговая': 14,
                'Кардио': 10,
                'Комплекс': 11,
                'Интенсивное': 16,
                'Выносливость': 9,
                'Заминка': 2
            };
            
            let totalCalories = 0;
            
            program.exercises.forEach(exercise => {
                const caloriesPerMinute = baseCaloriesPerMinute[exercise.category] || 6;
                const exerciseTime = (exercise.sets * 0.5) + (exercise.rest / 60); // примерное время в минутах
                totalCalories += caloriesPerMinute * exerciseTime;
            });
            
            return Math.round(totalCalories);
        }

        // Форматирование времени
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${minutes}:${secs.toString().padStart(2, '0')}`;
        }

        // Завершение упражнения
        window.completeExercise = function(day, exerciseIndex) {
            const key = `${day}-${exerciseIndex}`;
            if (!userData.completedExercises[key]) {
                userData.completedExercises[key] = true;
                saveUserData();
                
                // Проверить завершенность дня
                const dayProgram = workoutPrograms[day];
                if (dayProgram && !dayProgram.isRest) {
                    const totalExercises = dayProgram.exercises.length;
                    const completedCount = Object.keys(userData.completedExercises)
                        .filter(k => k.startsWith(`${day}-`)).length;
                    
                    if (completedCount >= totalExercises) {
                        completeDay(day);
                    }
                }
            }
        }

        // Завершение дня
        function completeDay(day) {
            if (!userData.completedDays.includes(day)) {
                userData.completedDays.push(day);
                userData.totalWorkouts++;
                
                // Записываем в историю тренировок
                const workoutRecord = {
                    date: new Date().toISOString(),
                    day: day,
                    duration: 120, // примерная длительность
                    calories: calculateCalories(day),
                    exercises: workoutPrograms[day]?.exercises?.length || 0
                };
                
                userData.workoutHistory.push(workoutRecord);
                
                updateStreak();
                saveUserData();
                generateDaySelector();
                
                // Показать детальное поздравление
                const program = workoutPrograms[day];
                showNotification(
                    '🎉 Тренировка завершена!', 
                    `${program.title}\nСожжено ~${workoutRecord.calories} калорий\nПродолжайте в том же духе!`
                );
            }
        }

        // Обновление серии
        function updateStreak() {
            let streak = 0;
            const today = new Date().getDay() || 7; // 1-7 (Пн-Вс)
            
            for (let i = today; i >= 1; i--) {
                if (userData.completedDays.includes(i)) {
                    streak++;
                } else {
                    break;
                }
            }
            
            userData.streak = streak;
        }

        // === НАВИГАЦИЯ ===

        window.showWorkout = function() {
            updateNavigation('workout');
            // Логика уже реализована выше
        }

        window.showStats = function() {
            updateNavigation('stats');
            openModal('Статистика', generateStatsContent());
        }

        window.showNutrition = function() {
            updateNavigation('nutrition');
            openModal('Питание и восстановление', generateNutritionContent());
        }

        window.showSettings = function() {
            updateNavigation('settings');
            openModal('Настройки', generateSettingsContent());
        }

        function updateNavigation(active) {
            document.querySelectorAll('.nav-item').forEach((item, index) => {
                const sections = ['workout', 'stats', 'nutrition', 'settings'];
                item.classList.toggle('active', sections[index] === active);
            });
        }

        // === МОДАЛЬНЫЕ ОКНА ===

        window.openModal = function(title, content) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('modal').classList.add('active');
        }

        window.closeModal = function() {
            document.getElementById('modal').classList.remove('active');
        }

        // Контент для статистики
        function generateStatsContent() {
            const totalCalories = userData.workoutHistory.reduce((sum, workout) => sum + (workout.calories || 0), 0);
            const avgWorkoutDuration = userData.workoutHistory.length > 0 
                ? userData.workoutHistory.reduce((sum, w) => sum + (w.duration || 0), 0) / userData.workoutHistory.length 
                : 0;
            
            return `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin-bottom: 24px;">
                    <div style="text-align: center; padding: 16px; background: var(--bg-card); border-radius: 8px;">
                        <div style="font-size: 24px; font-weight: bold; color: var(--accent-primary);">${userData.totalWorkouts}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">Тренировок</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-card); border-radius: 8px;">
                        <div style="font-size: 24px; font-weight: bold; color: var(--accent-secondary);">${userData.streak}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">Дней подряд</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-card); border-radius: 8px;">
                        <div style="font-size: 24px; font-weight: bold; color: var(--accent-primary);">${totalCalories}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">Сожжено калорий</div>
                    </div>
                    <div style="text-align: center; padding: 16px; background: var(--bg-card); border-radius: 8px;">
                        <div style="font-size: 24px; font-weight: bold; color: var(--accent-secondary);">${Math.round(avgWorkoutDuration)}</div>
                        <div style="font-size: 12px; color: var(--text-secondary);">Мин/тренировка</div>
                    </div>
                </div>
                
                <div style="background: var(--bg-card); padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                    <h3 style="margin-bottom: 16px;">🏆 Личные рекорды</h3>
                    ${Object.keys(userData.personalRecords).length > 0 ? `
                        <div style="display: grid; gap: 8px;">
                            ${Object.entries(userData.personalRecords).slice(0, 5).map(([exercise, record]) => `
                                <div style="display: flex; justify-content: space-between; align-items: center; padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                                    <span style="font-size: 14px;">${exercise}</span>
                                    <div style="font-size: 12px; color: var(--accent-primary);">
                                        ${record.maxWeight > 0 ? record.maxWeight + 'кг' : ''} 
                                        ${record.maxReps > 0 ? '× ' + record.maxReps : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : '<p style="color: var(--text-secondary); font-size: 14px;">Начните тренироваться, чтобы увидеть свои рекорды!</p>'}
                </div>
                
                <div style="background: var(--bg-card); padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                    <h3 style="margin-bottom: 16px;">📈 Прогресс недели</h3>
                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                        ${[1,2,3,4,5,6,7].map(day => {
                            const isCompleted = userData.completedDays.includes(day);
                            const dayProgram = workoutPrograms[day];
                            return `
                                <div style="
                                    width: 40px; 
                                    height: 40px; 
                                    border-radius: 50%; 
                                    display: flex; 
                                    align-items: center; 
                                    justify-content: center;
                                    background: ${isCompleted ? 'var(--accent-secondary)' : 'var(--bg-secondary)'};
                                    color: ${isCompleted ? 'white' : 'var(--text-secondary)'};
                                    font-weight: bold;
                                    position: relative;
                                " title="${dayProgram?.title || 'День ' + day}">
                                    ${day}
                                    ${isCompleted ? '<div style="position: absolute; bottom: -2px; right: -2px; background: var(--accent-primary); border-radius: 50%; width: 12px; height: 12px; font-size: 8px; display: flex; align-items: center; justify-content: center;">✓</div>' : ''}
                                </div>
                            `;
                        }).join('')}
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="showProgressDetails()" style="width: 100%; margin-bottom: 8px;">
                    📊 Подробная статистика
                </button>
                <button class="btn btn-secondary" onclick="showBodyMeasurements()" style="width: 100%;">
                    📏 Замеры тела
                </button>
            `;
        }

        // Контент для настроек
        function generateSettingsContent() {
            return `
                <div style="display: flex; flex-direction: column; gap: 16px;">
                    <button class="btn btn-secondary" onclick="requestNotificationPermission()">
                        Разрешить уведомления
                    </button>
                    <button class="btn btn-secondary" onclick="resetProgress()">
                        Сбросить прогресс
                    </button>
                    <button class="btn btn-secondary" onclick="exportData()">
                        Экспорт данных
                    </button>
                    <div style="margin-top: 24px; padding: 16px; background: var(--bg-card); border-radius: 8px;">
                        <h4 style="margin-bottom: 8px;">О приложении</h4>
                        <p style="font-size: 14px; color: var(--text-secondary); line-height: 1.5;">
                            FitnessPro v2.0.0<br>
                            Полная программа трансформации тела<br>
                            ✅ 7-дневные тренировки (2 часа)<br>
                            ✅ Система прогрессии и рекордов<br>
                            ✅ Спортивное питание и восстановление<br>
                            ✅ Замеры тела и аналитика<br><br>
                            Разработано с ❤️ для достижения ваших целей
                        </p>
                    </div>
                </div>
            `;
        }

        // === ФУНКЦИИ НАСТРОЕК ===

        window.requestNotificationPermission = function() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    showNotification('Уведомления', 
                        permission === 'granted' ? 'Уведомления разрешены!' : 'Уведомления отклонены');
                });
            }
        }

        window.resetProgress = function() {
            if (confirm('Вы уверены, что хотите сбросить весь прогресс?')) {
                userData = {
                    completedDays: [],
                    completedExercises: {},
                    streak: 0,
                    totalWorkouts: 0
                };
                saveUserData();
                generateDaySelector();
                loadWorkout(currentDay);
                closeModal();
                showNotification('Прогресс сброшен', 'Начните тренироваться заново!');
            }
        }

        window.exportData = function() {
            const dataStr = JSON.stringify(userData, null, 2);
            const dataBlob = new Blob([dataStr], {type:'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'fitnesspro_backup.json';
            link.click();
            URL.revokeObjectURL(url);
            showNotification('Экспорт завершен', 'Файл загружен в папку загрузок');
        }

        // Показать подробную статистику
        window.showProgressDetails = function() {
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 12px;">📈 Прогресс по упражнениям</h4>
                        ${Object.keys(userData.exerciseProgress).length > 0 ? `
                            <div style="display: grid; gap: 8px; max-height: 200px; overflow-y: auto;">
                                ${Object.entries(userData.exerciseProgress).map(([exercise, progress]) => {
                                    const dates = Object.keys(progress).sort();
                                    const lastSession = progress[dates[dates.length - 1]];
                                    const firstSession = progress[dates[0]];
                                    const improvement = lastSession && firstSession ? 
                                        ((lastSession.weight || 0) - (firstSession.weight || 0)) : 0;
                                    
                                    return `
                                        <div style="padding: 8px; background: var(--bg-secondary); border-radius: 4px;">
                                            <div style="font-weight: bold; margin-bottom: 4px;">${exercise}</div>
                                            <div style="font-size: 12px; color: var(--text-secondary);">
                                                Сессий: ${dates.length} | 
                                                Прогресс: ${improvement > 0 ? '+' + improvement : improvement} кг
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        ` : '<p style="color: var(--text-secondary);">Данных пока нет. Начните записывать результаты!</p>'}
                    </div>
                    
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 12px;">🏆 Достижения</h4>
                        ${Object.values(userData.personalRecords).some(r => r.achievements?.length > 0) ? `
                            <div style="max-height: 150px; overflow-y: auto;">
                                ${Object.entries(userData.personalRecords)
                                    .filter(([_, record]) => record.achievements?.length > 0)
                                    .map(([exercise, record]) => 
                                        record.achievements.map(achievement => `
                                            <div style="padding: 6px; margin-bottom: 6px; background: var(--bg-secondary); border-radius: 4px; font-size: 12px;">
                                                <strong>${exercise}:</strong> ${achievement.achievements.join(', ')}
                                                <div style="color: var(--text-secondary);">${new Date(achievement.date).toLocaleDateString()}</div>
                                            </div>
                                        `).join('')
                                    ).join('')}
                            </div>
                        ` : '<p style="color: var(--text-secondary);">Поставьте свой первый рекорд!</p>'}
                    </div>
                </div>
            `;
            
            openModal('Подробная статистика', modalContent);
        }

        // Показать замеры тела
        window.showBodyMeasurements = function() {
            const today = new Date().toISOString().split('T')[0];
            const lastMeasurement = userData.bodyMeasurements[today] || {};
            
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h4 style="margin-bottom: 12px;">📏 Записать замеры</h4>
                        <form onsubmit="saveMeasurements(event)" style="display: grid; gap: 12px;">
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;">
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Вес (кг)</label>
                                    <input type="number" id="weight-measurement" step="0.1" 
                                           value="${lastMeasurement.weight || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">% жира</label>
                                    <input type="number" id="bodyfat-measurement" step="0.1" min="0" max="50"
                                           value="${lastMeasurement.bodyFat || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Грудь (см)</label>
                                    <input type="number" id="chest-measurement" step="0.5"
                                           value="${lastMeasurement.chest || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Талия (см)</label>
                                    <input type="number" id="waist-measurement" step="0.5"
                                           value="${lastMeasurement.waist || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Бицепс (см)</label>
                                    <input type="number" id="bicep-measurement" step="0.5"
                                           value="${lastMeasurement.bicep || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                                <div>
                                    <label style="font-size: 12px; color: var(--text-secondary);">Бедро (см)</label>
                                    <input type="number" id="thigh-measurement" step="0.5"
                                           value="${lastMeasurement.thigh || ''}"
                                           style="width: 100%; padding: 8px; background: var(--bg-secondary); border: 1px solid var(--bg-primary); border-radius: 4px; color: var(--text-primary);">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary">Сохранить замеры</button>
                        </form>
                    </div>
                    
                    ${Object.keys(userData.bodyMeasurements).length > 0 ? `
                        <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                            <h4 style="margin-bottom: 8px;">📊 История замеров</h4>
                            <div style="max-height: 150px; overflow-y: auto; font-size: 12px;">
                                ${Object.entries(userData.bodyMeasurements)
                                    .sort(([a], [b]) => new Date(b) - new Date(a))
                                    .slice(0, 5)
                                    .map(([date, measurements]) => `
                                        <div style="padding: 6px; margin-bottom: 4px; background: var(--bg-secondary); border-radius: 4px;">
                                            <strong>${new Date(date).toLocaleDateString()}</strong><br>
                                            ${Object.entries(measurements).filter(([_, v]) => v).map(([key, value]) => 
                                                `${key}: ${value}${key === 'weight' ? 'кг' : key === 'bodyFat' ? '%' : 'см'}`
                                            ).join(' | ')}
                                        </div>
                                    `).join('')}
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
            
            openModal('Замеры тела', modalContent);
        }

        // Сохранить замеры
        window.saveMeasurements = function(event) {
            event.preventDefault();
            
            const today = new Date().toISOString().split('T')[0];
            const measurements = {
                weight: parseFloat(document.getElementById('weight-measurement').value) || null,
                bodyFat: parseFloat(document.getElementById('bodyfat-measurement').value) || null,
                chest: parseFloat(document.getElementById('chest-measurement').value) || null,
                waist: parseFloat(document.getElementById('waist-measurement').value) || null,
                bicep: parseFloat(document.getElementById('bicep-measurement').value) || null,
                thigh: parseFloat(document.getElementById('thigh-measurement').value) || null
            };
            
            // Удаляем null значения
            Object.keys(measurements).forEach(key => {
                if (measurements[key] === null) delete measurements[key];
            });
            
            if (Object.keys(measurements).length > 0) {
                userData.bodyMeasurements[today] = measurements;
                saveUserData();
                closeModal();
                showNotification('✅ Замеры сохранены', `Записано ${Object.keys(measurements).length} параметров`);
            } else {
                alert('Заполните хотя бы одно поле');
            }
        }

        // === ПИТАНИЕ И ВОССТАНОВЛЕНИЕ ===
        
        // Контент для питания
        function generateNutritionContent() {
            return `
                <div style="display: grid; gap: 16px;">
                    <!-- Основные добавки -->
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-primary);">💊 Основные добавки</h3>
                        
                        <div style="display: grid; gap: 12px;">
                            <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; border-left: 4px solid #10B981;">
                                <h4 style="color: #10B981; margin-bottom: 6px;">🥩 Протеин (Whey/Casein)</h4>
                                <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 6px;">
                                    <strong>Дозировка:</strong> 25-30г после тренировки, 20-25г перед сном (казеин)
                                </p>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    Восстанавливает мышцы, стимулирует синтез белка. Whey - быстрый, Casein - медленный.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; border-left: 4px solid #3B82F6;">
                                <h4 style="color: #3B82F6; margin-bottom: 6px;">⚡ Креатин моногидрат</h4>
                                <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 6px;">
                                    <strong>Дозировка:</strong> 3-5г ежедневно, можно с углеводами
                                </p>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    Увеличивает силу, мощность и объем мышц. Научно доказанная эффективность.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 12px; border-radius: 6px; border-left: 4px solid #F59E0B;">
                                <h4 style="color: #F59E0B; margin-bottom: 6px;">🐟 Омега-3 (EPA/DHA)</h4>
                                <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 6px;">
                                    <strong>Дозировка:</strong> 2-3г в день (1-2г EPA + 0.5-1г DHA)
                                </p>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    Уменьшает воспаление, ускоряет восстановление, улучшает суставы.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Дополнительные добавки -->
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-secondary);">🧪 Дополнительные добавки</h3>
                        
                        <div style="display: grid; gap: 10px;">
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #8B5CF6; margin-bottom: 4px;">💪 BCAA/EAA</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>10-15г во время тренировки.</strong> Предотвращает разрушение мышц.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #EC4899; margin-bottom: 4px;">🔥 L-Глютамин</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>5-10г после тренировки.</strong> Ускоряет восстановление, поддерживает иммунитет.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #14B8A6; margin-bottom: 4px;">🧠 Магний + Цинк</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>400мг Mg + 15мг Zn перед сном.</strong> Улучшает сон и восстановление.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #F97316; margin-bottom: 4px;">☀️ Витамин D3</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>2000-4000 МЕ в день.</strong> Поддерживает тестостерон, кости, иммунитет.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Предтренировочные -->
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #EF4444;">🚀 Предтренировочные</h3>
                        
                        <div style="display: grid; gap: 10px;">
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #DC2626; margin-bottom: 4px;">☕ Кофеин</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>200-400мг за 30 мин до тренировки.</strong> Энергия, фокус, жиросжигание.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #7C3AED; margin-bottom: 4px;">💜 Бета-аланин</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>3-5г в день.</strong> Уменьшает усталость в мышцах, увеличивает выносливость.
                                </p>
                            </div>

                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <h4 style="color: #059669; margin-bottom: 4px;">🌿 L-Цитруллин</h4>
                                <p style="font-size: 12px; color: var(--text-secondary);">
                                    <strong>6-8г за 30 мин до тренировки.</strong> Улучшает пампинг и кровоток.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Натуральное восстановление -->
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #10B981;">🌱 Натуральное восстановление</h3>
                        
                        <div style="display: grid; gap: 8px; font-size: 13px;">
                            <div style="background: var(--bg-secondary); padding: 8px; border-radius: 4px;">
                                <strong>😴 Сон:</strong> 7-9 часов качественного сна для максимального восстановления
                            </div>
                            <div style="background: var(--bg-secondary); padding: 8px; border-radius: 4px;">
                                <strong>💧 Вода:</strong> 35-40мл на кг веса + 500-750мл на каждый час тренировки
                            </div>
                            <div style="background: var(--bg-secondary); padding: 8px; border-radius: 4px;">
                                <strong>🍎 Еда:</strong> 1.6-2.2г белка на кг веса, сложные углеводы, полезные жиры
                            </div>
                            <div style="background: var(--bg-secondary); padding: 8px; border-radius: 4px;">
                                <strong>🧘‍♂️ Стресс:</strong> Медитация, растяжка, массаж для снижения кортизола
                            </div>
                        </div>
                    </div>

                    <!-- Схема приема -->
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-primary);">📅 Схема приема</h3>
                        <button class="btn btn-primary" onclick="showSupplementSchedule()" style="width: 100%; margin-bottom: 8px;">
                            Показать расписание приема
                        </button>
                        <button class="btn btn-secondary" onclick="showNutritionTips()" style="width: 100%;">
                            Советы по питанию
                        </button>
                    </div>

                    <!-- Важное предупреждение -->
                    <div style="background: #FEF3C7; color: #92400E; padding: 12px; border-radius: 8px; border-left: 4px solid #F59E0B;">
                        <h4 style="margin-bottom: 6px;">⚠️ Важно!</h4>
                        <p style="font-size: 12px; line-height: 1.4;">
                            Консультируйтесь с врачом перед приемом добавок. Данные рекомендации носят информационный характер и основаны на научных исследованиях для здоровых взрослых.
                        </p>
                    </div>
                </div>
            `;
        }

        // Показать расписание приема добавок
        window.showSupplementSchedule = function() {
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-primary);">🌅 Утром (6:00-8:00)</h3>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 20px;">
                            <li>Витамин D3 (2000-4000 МЕ)</li>
                            <li>Омега-3 (1г с завтраком)</li>
                            <li>Магний (200мг если не принимали на ночь)</li>
                        </ul>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #F59E0B;">🏋️‍♂️ Предтренировочно (за 30-45 мин)</h3>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 20px;">
                            <li>Кофеин (200-400мг)</li>
                            <li>L-Цитруллин (6-8г)</li>
                            <li>Бета-аланин (2-3г)</li>
                            <li>Креатин (3-5г можно в любое время)</li>
                        </ul>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #10B981;">🏃‍♂️ Во время тренировки</h3>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 20px;">
                            <li>BCAA/EAA (10-15г в воде)</li>
                            <li>Электролиты при долгих тренировках</li>
                            <li>Много воды!</li>
                        </ul>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #8B5CF6;">🍽️ После тренировки (0-30 мин)</h3>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 20px;">
                            <li>Whey протеин (25-30г)</li>
                            <li>Быстрые углеводы (банан, сок)</li>
                            <li>L-Глютамин (5-10г)</li>
                            <li>Омега-3 (1г с едой)</li>
                        </ul>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #6366F1;">🌙 Перед сном (за 1-2 часа)</h3>
                        <ul style="color: var(--text-secondary); font-size: 14px; margin: 0; padding-left: 20px;">
                            <li>Казеиновый протеин (20-25г)</li>
                            <li>Магний (200-400мг)</li>
                            <li>Цинк (15мг)</li>
                            <li>Мелатонин (0.5-3мг при необходимости)</li>
                        </ul>
                    </div>
                </div>
            `;
            
            openModal('Расписание приема добавок', modalContent);
        }

        // Показать советы по питанию
        window.showNutritionTips = function() {
            const modalContent = `
                <div style="display: grid; gap: 16px;">
                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-primary);">🥗 Основы питания</h3>
                        <div style="display: grid; gap: 10px; font-size: 14px;">
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <strong>Белки:</strong> 1.6-2.2г на кг веса (курица, рыба, яйца, творог)
                            </div>
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <strong>Углеводы:</strong> 3-7г на кг веса (овсянка, рис, гречка, фрукты)
                            </div>
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <strong>Жиры:</strong> 0.8-1.2г на кг веса (орехи, авокадо, оливковое масло)
                            </div>
                            <div style="background: var(--bg-secondary); padding: 10px; border-radius: 6px;">
                                <strong>Вода:</strong> 35-40мл на кг веса + дополнительно при тренировках
                            </div>
                        </div>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: var(--accent-secondary);">⏰ Время приема пищи</h3>
                        <div style="display: grid; gap: 8px; font-size: 13px;">
                            <div><strong>За 2-3 часа до тренировки:</strong> Полноценный прием пищи</div>
                            <div><strong>За 30-60 мин:</strong> Легкий перекус (банан + кофе)</div>
                            <div><strong>После тренировки:</strong> Белки + углеводы в течение 30 мин</div>
                            <div><strong>Перед сном:</strong> Казеин или творог для ночного восстановления</div>
                        </div>
                    </div>

                    <div style="background: var(--bg-card); padding: 16px; border-radius: 8px;">
                        <h3 style="margin-bottom: 12px; color: #F59E0B;">🚫 Чего избегать</h3>
                        <div style="display: grid; gap: 6px; font-size: 13px; color: var(--text-secondary);">
                            <div>• Большие порции перед тренировкой</div>
                            <div>• Избыток простых сахаров</div>
                            <div>• Недостаток белка в рационе</div>
                            <div>• Экстремальные диеты</div>
                            <div>• Игнорирование потребности в жирах</div>
                        </div>
                    </div>
                </div>
            `;
            
            openModal('Советы по питанию', modalContent);
        }

        // === УТИЛИТЫ ===

        function showNotification(title, message) {
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification(title, {
                    body: message,
                    icon: 'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%233B82F6"/><text x="50" y="65" font-size="40" text-anchor="middle" fill="white">💪</text></svg>'
                });
            } else {
                alert(`${title}: ${message}`);
            }
        }

        function loadUserData() {
            const saved = localStorage.getItem('fitnessPro_userData');
            if (saved) {
                userData = {...userData, ...JSON.parse(saved)};
            }
        }

        function saveUserData() {
            localStorage.setItem('fitnessPro_userData', JSON.stringify(userData));
        }

        function registerServiceWorker() {
            if ('serviceWorker' in navigator && location.protocol !== 'file:') {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed'));
            }
        }

        // === ИНИЦИАЛИЗАЦИЯ ===
        document.addEventListener('DOMContentLoaded', function() {
            initApp();
            registerServiceWorker();
            
            // Запросить разрешение на уведомления
            if ('Notification' in window && Notification.permission === 'default') {
                setTimeout(() => {
                    Notification.requestPermission();
                }, 2000);
            }
            
            console.log('FitnessPro v1.2.0 - Clean version loaded! 💪');
        });

        // Закрытие модального окна по клику на фон
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
</body>
</html>
